Machine name: Crocodile
Kali IP: 10.10.14.58
Target IP: 10.129.1.15

Task 1: What Nmap scanning switch employs the use of default scripts during a scan?

- -sC

Task 2: What service version is found to be running on port 21?

- We need to scan the ports to understand what is avaialble on port 21
- We were given the hint to us -sC flag for all scripts

```bash ─[us-starting-point-vip-1-dhcp]─[10.10.14.58]─[hbruinsma@htb-rugyfugin2]─[~]
└──╼ [★]$ nmap -sC -p21 -T4 10.129.1.15
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-19 00:09 CDT
Nmap scan report for 10.129.1.15
Host is up (0.24s latency).

PORT   STATE SERVICE
21/tcp open  ftp
| ftp-syst:
|   STAT:
| FTP server status:
|      Connected to ::ffff:10.10.14.58
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 3
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| -rw-r--r--    1 ftp      ftp            33 Jun 08  2021 allowed.userlist
|_-rw-r--r--    1 ftp      ftp            62 Apr 20  2021 allowed.userlist.passwd

Nmap done: 1 IP address (1 host up) scanned in 3.33 seconds
```

Answer: vsFTPd 3.0.3

Task 3: What FTP code is returned to us for the "Anonymous FTP login allowed" message?

- When we performed the nmap scan the -sC script scan tried anonymous login for us already

```bash
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
```

Answer: 230

Task 4: After connecting to the FTP server using the ftp client, what username do we provide when prompted to log in anonymously?

- Anonymous

Task 5: After connecting to the FTP server anonymously, what command can we use to download the files we find on the FTP server?

- Now we must connect using the ftp service

```bash
─[us-starting-point-vip-1-dhcp]─[10.10.14.58]─[hbruinsma@htb-rugyfugin2]─[~]
└──╼ [★]$ ftp 10.129.1.15
Connected to 10.129.1.15.
220 (vsFTPd 3.0.3)
Name (10.129.1.15:root): Anonymous
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp>
```

- Now we are logged in
- We can download the files using the get command
- First we want to view the files that exist using "ls"

```bash
ftp> ls
229 Entering Extended Passive Mode (|||42511|)
150 Here comes the directory listing.
-rw-r--r--    1 ftp      ftp            33 Jun 08  2021 allowed.userlist
-rw-r--r--    1 ftp      ftp            62 Apr 20  2021 allowed.userlist.passwd
226 Directory send OK.
```

- We can see there are so useful files including allowed.userlist and some passwords, we probably want both of those, lets use the "get" command

```bash
ftp> get allowed.userlist
local: allowed.userlist remote: allowed.userlist
229 Entering Extended Passive Mode (|||41731|)
150 Opening BINARY mode data connection for allowed.userlist (33 bytes).
100% |***********************************|    33       15.20 KiB/s    00:00 ETA
226 Transfer complete.
33 bytes received in 00:00 (0.12 KiB/s)
ftp> get allowed.userlist.passwd
local: allowed.userlist.passwd remote: allowed.userlist.passwd
229 Entering Extended Passive Mode (|||42461|)
150 Opening BINARY mode data connection for allowed.userlist.passwd (62 bytes).
100% |***********************************|    62        9.27 KiB/s    00:00 ETA
226 Transfer complete.
62 bytes received in 00:00 (0.24 KiB/s)
ftp> exit
221 Goodbye.
┌─[us-starting-point-vip-1-dhcp]─[10.10.14.58]─[hbruinsma@htb-rugyfugin2]─[~]
└──╼ [★]$ ls
allowed.userlist         cacert.der  Documents  Music    Pictures  Templates
allowed.userlist.passwd  Desktop     Downloads  my_data  Public    Videos
```

Answer: get

Task 6: What is one of the higher-privilege sounding usernames in 'allowed.userlist' that we download from the FTP server?

- We must view the usernames and passwords now using our "cat" command

```bash
┌─[us-starting-point-vip-1-dhcp]─[10.10.14.58]─[hbruinsma@htb-rugyfugin2]─[~]
└──╼ [★]$ cat allowed.userlist
aron
pwnmeow
egotisticalsw
admin
┌─[us-starting-point-vip-1-dhcp]─[10.10.14.58]─[hbruinsma@htb-rugyfugin2]─[~]
└──╼ [★]$ cat allowed.userlist.passwd
root
Supersecretpassword1
@BaASD&9032123sADS
rKXM59ESxesUFHAd
```

Answer: admin

Task 7: What version of Apache HTTP Server is running on the target host?

- This task implies there is a web server running on port 80, lets enumerate using nmap

```bash
┌─[us-starting-point-vip-1-dhcp]─[10.10.14.58]─[hbruinsma@htb-rugyfugin2]─[~]
└──╼ [★]$ nmap -sV -sC -p80,443 10.129.1.15
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-19 00:26 CDT
Nmap scan report for 10.129.1.15
Host is up (0.24s latency).

PORT    STATE  SERVICE VERSION
80/tcp  open   http    Apache httpd 2.4.41 ((Ubuntu))
|_http-title: Smash - Bootstrap Business Template
|_http-server-header: Apache/2.4.41 (Ubuntu)
443/tcp closed https

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.00 seconds
```

- We can see there is a webservice running on port 80
- We can see the version of apache is 2.4.41
  Answer: Apache httpd 2.4.41

Task 8: What switch can we use with Gobuster to specify we are looking for specific filetypes?

- This implies we must enumerate the web service using gobuster
- We must use the "-x" switch to specify the filetypes we are looking for
  Answer: -x

Task 9: Which PHP file can we identify with directory brute force that will provide the opportunity to authenticate to the web service?

- This tells us we need to look for a php file so for the -x flag we put "php" afterwards
- gobuster dir -u http://10.129.1.15 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php -t 50
- dir = directory search
- -u = url
- -w = wordlist
- -x = filetypes
- -t = threads (speed)
  Answer: login.php

Final task - submit flags:

- This implied we have everything we need to know in order to grab the flags
- We have credentials (task 6)
  - admin
  - rKXM59ESxesUFHAd
- We have a login location (task 9)
  - http://10.129.1.15/login.php
- Lets login at that website, open firefox and navigate to http://10.129.1.15/login.php
- We managed to login using the admin credentials we discovered from the ftp anonymous login and the flag is displayed there for us to grab
  Answer: c7110277ac44d78b6a9fff2232434d16
